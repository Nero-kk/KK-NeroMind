# ğŸ“„ .kknm JSON Schema v1 (Final)

## 1. ê°œìš” ë° ì„¤ê³„ ì² í•™

ë³¸ ë¬¸ì„œëŠ” **KK-NeroMind**ì˜ ì „ìš© íŒŒì¼ í¬ë§·ì¸ `.kknm`ì˜ **ìµœì¢… ì •ë³¸(Canonical Specification)**ì´ë‹¤.  
ëª¨ë“  ì½ê¸°/ì“°ê¸°/ë§ˆì´ê·¸ë ˆì´ì…˜/ë Œë”ë§ ë¡œì§ì€ **TextFileView Skeleton í—Œë²•**ì„ ìµœìš°ì„  ê·œë²”ìœ¼ë¡œ ì‚¼ì•„ ë³¸ ìŠ¤í‚¤ë§ˆë¥¼ ì—„ê²©íˆ ë”°ë¥¸ë‹¤.

### í•µì‹¬ ì›ì¹™

- **Single Source of Truth**  
    `.kknm` íŒŒì¼ ìì²´ê°€ ìœ ì¼í•œ ì§„ì‹¤ì˜ ì›ì²œì´ë‹¤.
    
- **Schema is Law**  
    ë³¸ ìŠ¤í‚¤ë§ˆì— ì •ì˜ë˜ì§€ ì•Šì€ ë°ì´í„°ëŠ” ì¶”ì¸¡Â·ë³´ì •Â·ë³µêµ¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
    
- **Fail Loudly**  
    ê·œê²© ìœ„ë°˜ ë°ì´í„°ëŠ” ì¦‰ì‹œ ê±°ë¶€í•œë‹¤. ì¹¨ë¬µ ì‹¤íŒ¨(Silent Corruption)ëŠ” í—ˆìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
    

---

## 2. íŒŒì¼ ë©”íƒ€ë°ì´í„° (Meta Section)

íŒŒì¼ì˜ ì •ì²´ì„±ê³¼ í˜¸í™˜ì„±ì„ íŒë³„í•˜ëŠ” **íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ ì˜ì—­**ì´ë‹¤.

```json
{
  "meta": {
    "createdWith": "KK-NeroMind",
    "schemaVersion": 1,
    "pluginVersion": "0.4.2",
    "createdAt": "ISO-8601",
    "updatedAt": "ISO-8601"
  }
}
```

### ê²€ì¦ ë° ì ìš© ê·œì¹™

- **Identity Check**  
    `createdWith !== "KK-NeroMind"` ì¸ ê²½ìš° ê¸°ë³¸ì ìœ¼ë¡œ ë¡œë“œë¥¼ ê±°ë¶€í•œë‹¤.
    
- **Schema Authority**  
    `schemaVersion`ì€ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒë‹¨ì˜ **ìœ ì¼í•œ ê¸°ì¤€**ì´ë‹¤.
    
- **Forward-only Migration**  
    ë§ˆì´ê·¸ë ˆì´ì…˜ì€ í•˜ìœ„ â†’ ìƒìœ„ë¡œë§Œ ìˆ˜í–‰ë˜ë©°, ì—­ë°©í–¥ í˜¸í™˜ì€ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.
    
- **Audit Trail**  
    `pluginVersion`ì€ ë§¤ `serialize()` ì‹œì ì— ê¸°ë¡ë˜ë©°, ì‚¬í›„ ë””ë²„ê¹… ë° í˜¸í™˜ì„± ë¶„ì„ ìš©ë„ë¡œë§Œ ì‚¬ìš©ëœë‹¤.
    
- **Timestamp Authority**  
    `updatedAt`ì€ **serialize() ìˆ˜í–‰ ì‹œì ì—ë§Œ** ê°±ì‹ ëœë‹¤.  
    View ìƒíƒœ ë³€ê²½ì´ë‚˜ UI-only ì´ë²¤íŠ¸ë¡œëŠ” ìˆ˜ì •ë˜ì§€ ì•ŠëŠ”ë‹¤.
    

---

## 3. ë…¸ë“œ êµ¬ì¡° (Nodes Section)

ë§ˆì¸ë“œë§µì„ êµ¬ì„±í•˜ëŠ” ìµœì†Œ ì˜ë¯¸ ë‹¨ìœ„ì´ë‹¤.

```json
"nodes": [
  {
    "id": "uuid-v4",
    "type": "default",
    "text": "ë…¸ë“œ ë‚´ìš©",
    "position": { "x": 100, "y": 200 },
    "style": {},
    "updatedAt": "ISO-8601"
  }
]
```

### ì„¤ê³„ ê·œì¹™

- **Stable Identity**  
    `id`ëŠ” íŒŒì¼ ìƒì• ì£¼ê¸° ë™ì•ˆ ì ˆëŒ€ ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤.
    
- **Style Isolation**  
    `style` ê°ì²´ëŠ” v1ì—ì„œ **ë¹ˆ ê°ì²´ë¡œë§Œ ìœ ì§€**í•œë‹¤.  
    ì „ì—­ í…Œë§ˆë‚˜ ê³µí†µ ìŠ¤íƒ€ì¼ì€ íŒŒì¼ ë°ì´í„°ì— ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.
    
- **updatedAt Usage Rule**  
    `updatedAt`ì€ ì¶©ëŒ ë¶„ì„ì´ë‚˜ ë™ê¸°í™” íŒíŠ¸ë¡œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°,  
    ë Œë”ë§ ìš°ì„ ìˆœìœ„ë‚˜ ì˜ë¯¸ë¡ ì  íŒë‹¨ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ëœë‹¤.
    

---

## 4. ì—£ì§€ êµ¬ì¡° (Edges Section)

ë…¸ë“œ ê°„ì˜ ê´€ê³„ë¥¼ ì •ì˜í•˜ëŠ” íŒŒìƒ ë°ì´í„°ë‹¤.

```json
"edges": [
  {
    "id": "uuid-v4",
    "from": "node-id-1",
    "to": "node-id-2",
    "type": "directed"
  }
]
```

### ë°ì´í„° ì •í™”(Sanitation) ê·œì¹™

- **Reference Integrity**  
    `from` ë˜ëŠ” `to`ì— í•´ë‹¹í•˜ëŠ” ë…¸ë“œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°,  
    í•´ë‹¹ ì—£ì§€ëŠ” `deserialize()` ë‹¨ê³„ì—ì„œ **ì¦‰ì‹œ ì˜êµ¬ ì‚­ì œ(Drop)**í•œë‹¤.
    
- **Sanitation â‰  Data Loss**  
    ì´ëŠ” ë°ì´í„° ì†ì‹¤ì´ ì•„ë‹ˆë¼ **ë¬´ê²°ì„± íšŒë³µ ê³¼ì •**ìœ¼ë¡œ ê°„ì£¼í•œë‹¤.
    

---

## 5. ë·° ìƒíƒœ (View Section)

ì‘ì—… ì—°ì†ì„±ì„ ìœ„í•œ **ë³´ì¡°ì  UI ìƒíƒœ ë°ì´í„°**ë‹¤.

```json
"view": {
  "zoom": 1.0,
  "pan": { "x": 0, "y": 0 },
  "selectedNodeId": null
}
```

### UX ë³µì› ê·œì¹™

- **Best-effort Hint**  
    `selectedNodeId`ëŠ” ì‘ì—… ë§¥ë½ ë³µì›ì„ ìœ„í•œ íŒíŠ¸ì¼ ë¿ì´ë‹¤.
    
- **Silent Ignore**  
    í•´ë‹¹ ë…¸ë“œê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ë·°ê°€ ì½ê¸° ì „ìš©ì¼ ê²½ìš°,  
    ê²½ê³  ì—†ì´ ì¡°ìš©íˆ ë¬´ì‹œí•œë‹¤.
    

---

## 6. ê¸ˆì§€ ë° ì œí•œ ì‚¬í•­ (Restrictions)

- **No extraData**  
    v1ì—ì„œëŠ” ì„ì˜ í™•ì¥ í•„ë“œ(`extraData`)ë¥¼ ì „ë©´ ê¸ˆì§€í•œë‹¤.
    
- **No Implicit Fields**  
    ì§ë ¬í™” ì‹œ ìŠ¤í‚¤ë§ˆì— ëª…ì‹œë˜ì§€ ì•Šì€ í•„ë“œë¥¼ ì¶”ê°€í•´ì„œëŠ” ì•ˆ ëœë‹¤.
    
- **No Heuristic Recovery**  
    ê·œê²© ìœ„ë°˜ ë°ì´í„°ì— ëŒ€í•´ ì¶”ì¸¡ ê¸°ë°˜ ë³µêµ¬ë¥¼ ì‹œë„í•˜ì§€ ì•ŠëŠ”ë‹¤.
    

---

## 7. ìŠ¤í‚¤ë§ˆì˜ ì§€ìœ„

ë³¸ ë¬¸ì„œëŠ” **TextFileView Skeleton**ê³¼ 1:1ë¡œ ê²°ë°•ë˜ë©°,  
ëª¨ë“  êµ¬í˜„ì€ ì´ ìŠ¤í‚¤ë§ˆë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ ëŠ” ë™ì‘ ê·œì¹™ì„ ë°”ê¿€ ìˆ˜ ì—†ë‹¤.

> **Schema changes require version increment.**  
> ìŠ¤í‚¤ë§ˆ ë³€ê²½ì€ ë°˜ë“œì‹œ ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œë§Œ ì´ë£¨ì–´ì§„ë‹¤.

---

**Status:** Final (v1)  
**Binding:** TextFileView Skeleton v4.2.5  
**Authority:** KK-NeroMind Architecture